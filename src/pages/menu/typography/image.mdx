---
layout: "@layout/main.astro"
title: 图片
---

import T from "src/components/T.astro";
import escape from "src/scripts/server/escape";
import { Icon } from "astro-icon";
import example from "src/assets/images/example.jpg";
import "src/components/image/iine.styl";
import Uploader from "src/components/image/uploader.astro";
export * from 'src/components/markdown/map.mdx';


# image

![示例](./../../../assets/images/example.jpg)

{/**
  * 不支持相对路径开发时请忽略这个404错误
  * 使用绝对路径：
  * ![示例](/src/assets/images/example.jpg)
  */}

以上图片的显示来自拓展后的markdown。但是故意写错了src导致**加载失败**的效果。


## `<img>`

以**容器**方式

低版本浏览器需要指定 `width`

<T class='☘-image' style="width:300px">
    <img alt="示例" src={example} />
</T>

```pug
.☘-image(style="width:300px")
    img(alt="示例" src='/src/assets/images/example.jpg')
```


## `background-image`

以**背景**方式

必须以某种方式指定宽高 

比如指定 `height` 和 `aspect-ratio`

也可用 `display: flex` 这相当于 `width: 100%`

<T class='☘-image' style={{
    display: 'flex',
    height: '300px',
    'background-image': `url(${example})`
}}>
    <T tag="p" class="☘-paragraph" data-size="1">🍂</T>
</T>

```pug
.☘-image(style={
    display: 'flex',
    height: '300px',
    'background-image': url('/src/assets/images/example.png')
})
    p.☘-paragraph(data-size=1) 🍂
```


## mask

背景图或容器都可以使用的遮罩 `.☘-image>.☘-image-mask`

<T class='☘-image' style={{
    width: '100px',
    height: '100px',
    'background-image': `url(${example})`,
    'border-radius': '50%'
}}>
    <T
        class='☘-image-mask'
        role="button"
        aria-label="like"
        onclick="
            event.target == this || this.parentElement.toggleAttribute('data-iine')
        "
    >
        <Icon name="interactive-button/outline/heart" width="24px"/>
        <Icon name="interactive-button/fill/heart-fill" width="24px"/>
    </T>
</T>


```pug
.☘-image(style={
    width: '100px',
    height: '100px',
    'background-image': url('/src/assets/images/example.jpg'),
    'border-radius': '50%'
})
    .☘-image-mask(onclick=function(){
        event.target == this || this.parentElement.toggleAttribute('data-iine')
    })
        svg(width="24px" astro-icon='interactive-button/outline/heart')
        svg(width="24px" astro-icon='interactive-button/fill/heart-fill')

style(lang='stylus').
    .☘-image
        svg[astro-icon='interactive-button/outline/heart']
        svg[astro-icon='interactive-button/fill/heart-fill']
            color _rgb(var(--magenta-6))
            cursor pointer
        
        &[data-iine] svg[astro-icon='interactive-button/outline/heart']
        &:not([data-iine]) svg[astro-icon='interactive-button/fill/heart-fill']
            display none
```

### footer

适用于大尺寸图片（ 128像素以上 ）的底部遮罩 `.☘-image>.☘-image-footer`

<T class='☘-image' style="
    width:300px;
    height:300px;
    border-radius:var(--border-radius-lg)
">
    <img alt="示例" src={example} />
    <T class='☘-image-footer'>
        <T class="☘-image-footer-content">
            <T
                class="☘-title"
                data-size='5'
            > 标题标题标题标题标题标题标题标题标题标题标题 </T>
            <T
                class="☘-paragraph"
                data-ellipsis="1"
            > 描述描述描述描述描述描述描述描述描述描述描述描述 </T>
        </T>
        <T class="☘-image-footer-action">
            <Icon
                class={escape('☘-link')}
                name="interactive-button/outline/eye"
                role="button"
                aria-label="Open the image in a new tab"
                width="24px"
                onclick={`
                    window.open('${example}')
                `}
            />
            <Icon
                class={escape('☘-link')}
                name="interactive-button/outline/download"
                role="button"
                aria-label="Download the image"
                width="24px"
            />
        </T>
    </T>
</T>

```pug
.☘-image(style={
    width: "300px",
    height: "300px",
    "border-radius": "var(--border-radius-lg)"
})
    img(alt="示例" src='/src/assets/images/example.jpg')
    .☘-image-footer
        .☘-image-footer-content
            .☘-title(data-size=5) 标题标题标题标题标题标题标题标题标题标题标题
            .☘-paragraph(data-ellipsis="1") 描述描述描述描述描述描述描述描述描述描述描述描述
        .☘-image-footer-action
            svg.☘-link(
                role="button"
                aria-label="Open the image in a new tab"
                width="24px"
                onclick=function(){
                    window.open("/src/assets/images/example.jpg")
                }
            )
            svg.☘-link(
                role="button"
                aria-label="Download the image"
                width="24px"
            )
```

以下全局变量可以修改部分样式

- `--color-image` 字体颜色
- `--color-image-mask` 遮罩颜色

局部还定义了 `☘-link` 的颜色样式 需要一并修改


## upload

配合 `.☘-input-wrapper>input[type=file].☘-input` 使用即可

<Uploader 
    disabled
    style="
        width:100px;
        height:100px;
" />

<Uploader 
    id="uploader"
    title="点击上传图片"
    style="
        width:100px;
        height:100px;
    "
    dataset={{primary: true}}
/>

这里实现使用了 `:has()` 选择器，如果你的浏览器不支持会被降级, 样式会有些许区别

```pug
span.☘-image.☘-input-wrapper(style={
    width: '100px',
    height: '100px',
})
    input.☘-input(type='file' disabled)
    svg(width="24px")

span.☘-image.☘-input-wrapper(style={
    width: '100px',
    height: '100px',
} data-primary)
    input.☘-input#uploader(
        type='file'
        title='点击上传图片'
        onchange=function(e){
            const reader = new FileReader();
            reader.readAsDataURL(e.target.files[0]);
            reader.onload = () => {
                this.parentElement.style.backgroundImage = `url(${reader.result})`;
            };
        }
    )
    svg(width="24px")
```

`.☘-input-wrapper` 也可以使用局部变量 `--color-input-wrapper` 修改颜色
